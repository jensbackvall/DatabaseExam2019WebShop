<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Productview</title>
    <script src="https://code.jquery.com/jquery-3.3.1.js" type="text/javascript"></script>
    <script src="../productview/productview.js"></script>
    <link rel="stylesheet" type="text/css" href="../productview/productview.css" />
    <link rel="stylesheet" type="text/css" href="../main.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body>
    <header>
        <div class="logo">
            <img src="../images/logo.png" alt="logo">
        </div>
        <div class="mid-header"></div>
        <div class="loginregister">
            <button class="gotologinbutton" onclick="window.location.href = '../login/login.html';">LOG IN</button>
            <button class="gotoregisterbutton" onclick="window.location.href = '../register/register.html';">REGISTER NEW USER</button>
            <br><br><br>
            <a class="cart" href="../shopping-basket/shoppingbasket.html"><img src="../images/cart.png" alt="cart"></a>
        </div>
    </header>
    <main>
        <div class="product">
        <!-- Rating stars added below-->
        Rating:
            <div class="stars-outer">
                <div class="stars-inner"></div>
            </div>
        <!---->
        </div>
        <div class="purchasing-line">
            <div class="rating-box">
                Rate number of stars:
                <select name="rating" id="ratingField">
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                </select><br><br>
                <textarea placeholder="comment (optional)" rows="3" cols="70" id="commentField"></textarea><br><br>
                <button class="rating-button" id="ratingButton">Rate Product</button>
            </div>
            <div class="purchasing-box">
                <button class="purchasing-button" id="addCart">Add to cart</button>
            </div>
        </div>
    </main>
    <footer></footer>
</body>
<script>
    // Get the name and password for user validation
    $("#addCart" ).click((event) => {
        event.preventDefault();
        let id = window.localStorage.getItem('userid');
        if (id === null){
            console.log("Id not found");
        }else {
            console.log("Id found: ", id);
        }
    });  
    if (window.localStorage.getItem('username') != null) {
        $(".mid-header").html("Logged in as: " + window.localStorage.getItem('username') + "<br><br><button type='submit'  id='logOutButton'>Log Out</button>");    
    }

    $("#logOutButton").click((event) => {
        window.localStorage.removeItem("username");
        window.localStorage.removeItem("userid");
        $(".mid-header").remove(`#logOutButton`);
        location.reload(true);
    });

    $("#ratingButton").click((event) => {
        console.log("Inside ratingButton")
        event.preventDefault();
        const jsonFormObj = {"rating":$("#ratingField").val(), "comment":$("#commentField").val()};
        console.log(jsonFormObj); 
        $.ajax({
            url: '/rating',
            type: 'POST',
            data: jsonFormObj,
            dataType: 'json'
        }).done(function(data){
            console.log(data);
            location.reload(true);
        })
    });

</script>
</html>
